# cutkey

**License: Apache 2**

cutkey is an Erlang app for generating RSA keys. It is implemented as a port driver that calls [OpenSSL's RSA_generate_key](http://www.openssl.org/docs/crypto/RSA_generate_key.html) on a thread from the async pool.

### Prerequistes

* OpenSSL
* [rebar](https://github.com/basho/rebar) - builds with `rebar compile`

### Example use


```
1> ok=application:start(cutkey).
ok
```
`cutkey:rsa(Bits,E)` returns a key as a list of binary mpints (multi-precision integers) in `[E,N,D]` form.


```
2> {ok,PrivateKey}=cutkey:rsa(256,257).
{ok,[<<0,0,0,2,1,1>>,
     <<0,0,0,33,0,183,107,145,202,176,20,78,187,129,147,251,114,222,65,159,66,
       195,79,171,232,160,248,214,233,80,181,8,116,214,99,120,161>>,
     <<0,0,0,32,43,137,24,164,167,77,137,57,116,107,215,19,75,169,248,249,
       135,183,240,238,251,123,149,57,3,135,122,160,34,105,36,1>>]}
```
This format can be used directly with the [crypto apps RSA](http://erlang.org/doc/man/crypto.html#rsa_sign-2) functions:


```
3> CipherText=crypto:rsa_private_encrypt(<<"cutkey">>,PrivateKey,rsa_pkcs1_padding).
<<34,39,143,191,166,208,236,75,221,13,187,95,136,206,128,206,55,245,45,22,42,
  164,163,112,155,148,84,167,212,214,101,12>>
4> PublicKey=lists:sublist(PrivateKey,2).
[<<0,0,0,2,1,1>>,
 <<0,0,0,33,0,183,107,145,202,176,20,78,187,129,147,251,114,222,65,159,66,195,
   79,171,232,160,248,214,233,80,181,8,116,214,99,120,161>>]
5> crypto:rsa_public_decrypt(CipherText,PublicKey,rsa_pkcs1_padding).
<<"cutkey">>
```
To return integers rather than mpints call `cutkey:rsa(Bits,E,[erlint])`.


```
6> cutkey:rsa(256,257,[erlint]).
{ok,[257,
     80184169397926965073253130820415273912758834295962307107668576496229822802787,
     43680092279026362296713767762093923531933652436653352798037359463427048749313]}
```
`cutkey:rsa(Bits, E,[{return,full}]` returns all the keys component as `[E,N,D,P,Q,DMP1,DMQ1,IQMP]`.


```
7> cutkey:rsa(256,257,[{return,full}]).
{ok,[<<0,0,0,2,1,1>>,
     <<0,0,0,33,0,197,228,220,38,79,28,107,10,9,17,6,17,184,204,254,16,199,160,
       103,183,183,94,126,138,60,253,165,106,169,237,120,123>>,
     <<0,0,0,33,0,187,29,31,216,132,147,102,52,82,72,223,226,239,123,26,14,51,
       225,17,145,91,223,16,180,135,33,22,41,127,240,178,145>>,
     <<0,0,0,17,0,230,49,37,161,1,46,188,218,74,85,107,98,158,243,52,115>>,
     <<0,0,0,17,0,220,20,182,91,68,42,142,78,199,211,49,87,105,84,49,217>>,
     <<0,0,0,16,17,233,237,3,144,135,31,161,108,98,74,25,154,208,47,233>>,
     <<0,0,0,17,0,198,172,25,41,140,58,86,160,196,83,17,165,145,226,106,193>>,
     <<0,0,0,17,0,160,247,110,158,147,42,12,166,155,6,204,16,23,66,124,197>>]}
8> cutkey:rsa(256,257,[{return,full},erlint]).
{ok,[257,
     99522795391046366132676968412529052027199956989740563062506434995223722634563,
     63121461668251197196989672572926986304787971322689337632675046498443068159145,
     337791478734506827017223088236821466487,
     294627904066425734891132458521450144149,
     245786017600594461681792675098387604019,
     6878472468476865406018656619177824377,
     19586521795052827679010802063938856290]}
```
An `#'RSAPrivateKey'{}` for use with the [public_key](http://erlang.org/doc/man/public_key.html) app can be generated by calling `cutkey:rsa(Bits,E,[{return,key}])`.


```
9> cutkey:rsa(256,257,[{return,key}]).
{ok,{'RSAPrivateKey','two-prime',
                     97132022012594670320943786548017456079929212368237896142187844346848005585121,
                     257,
                     29479757653627954416473211481499461378155029569207901883814856314762103734841,
                     320008735454582812961489622113791644503,
                     303529282957277635118430713274461891207,
                     27393743891053781654290940414410179685,
                     188967646977293469334431572466591060673,
                     275082882285760083709585418631671996440,asn1_NOVALUE}}
